#!/usr/bin/env bash
#  _       __      ____
# | |     / /___ _/ / /___  ____ _____  ___  _____
# | | /| / / __ `/ / / __ \/ __ `/ __ \/ _ \/ ___/
# | |/ |/ / /_/ / / / /_/ / /_/ / /_/ /  __/ /
# |__/|__/\__,_/_/_/ .___/\__,_/ .___/\___/_/
#                 /_/         /_/

CURRENT_THEME=$(cat ~/.config/colorschemes/.current-theme)
echo "$CURRENT_THEME"
THEME_DIR="$HOME/.config/colorschemes"
WALLPAPER_DIR="$THEME_DIR/$CURRENT_THEME/wallpapers"
echo "$WALLPAPER_DIR"

CURRENT_WALL=$(swww query | sed 's/.*image: //')

# Get a random wallpaper that is not the current one
WALLPAPER=$(find "$WALLPAPER_DIR" -type f ! -name "$(basename "$CURRENT_WALL")" | shuf -n 1)

echo "$WALLPAPER"

if [[ -z "$WALLPAPER" ]]; then
  exit 1
fi

# Apply the selected wallpaper
swww img "$WALLPAPER" --transition-type wipe --transition-fps 144
#
# For hyprlock to have the same Background
cp "$WALLPAPER" ~/.current_wallpaper
